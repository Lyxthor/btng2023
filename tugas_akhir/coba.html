<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draggable Element</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        .container {
            position: relative;
            max-width: 960px;
            height: 100vh;
            margin: 0 auto;
            background-color: salmon;
            justify-content: space-between;
            flex: wrap;
        }
        .box {
            position: absolute;
            width: 100px;
            aspect-ratio: 1/1;
            background-color: royalblue;
            border-radius: 1rem;
            flex-grow: 0;
        }
        .box.long {
            width: 200px;
            aspect-ratio: 2/1;
            background-color: red;
        }
        .box.tall {
            aspect-ratio: 1/2;
            background-color: olivedrab;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <div class="box tall"  draggable="true">1</div>
        <div class="box"  draggable="true">2</div>
        <div class="box tall"  draggable="true">3</div>
        <div class="box"  draggable="true">4</div>
        <div class="box long"  draggable="true">5</div>
        <div class="box tall"  draggable="true">6</div>
        <div class="box"  draggable="true">7</div>
    </div>
</body>
<script>
    const boxes = document.querySelectorAll('.box')
    let x_pos, y_pos
    let colTemplate = 1
    let multiplierY = multiplierX = col = row = 0
    let breakY = {
        row: 0,
        pos: [[]]
    }
    let defSize = 100
    boxes.forEach((box, index)=>{
        x_pos = (defSize) * col + (multiplierX*defSize)
        multiplierY = breakY.pos[row].includes(x_pos) ? 1 : 0;
        y_pos = (defSize) * row + (multiplierY*defSize)
        box.style.transform=`translate(${x_pos}px, ${y_pos}px)`
       
        if(box.classList.contains('long')) {multiplierX++}
        else if(box.classList.contains('tall')) {
            breakY.row = row+1
            breakY.pos.push([])
            breakY.pos[row+1].push(x_pos)
        }
        
        
        if(col === colTemplate) {
            col = 0
            row++
            multiplierX = 0
            // if(breakY.pos != []) {
            //     breakY.pos = []
            // }
            // multiplierY = 0
        } else {
            col++
        }
        
        // row = col === 3 ? row+1 : row 
        // col = col === 3 ? 0 : col+1
        // multiplierX = box.classList.contains('long') ? 1 : 0
        // multiplierY = box.classList.contains('tall') ? 1 : 0
    })
    window.onload=()=>{

    }
</script>
<script>
    // const box = document.querySelector('.box')
    // const container = document.querySelector('.container')
    // box.onmousedown=()=>{
    //     box.style.cursor="move"
    //     document.onmouseup=mouseUp
    //     document.onmousemove=movebox
    // }
    // function movebox(e) {
    //     e = e || window.event
    //     var x_pos = e.clientX-(window.innerWidth-960)/2
    //     var y_pos = e.clientY-50
    //     box.style.left=x_pos+"px"
    //     box.style.top=y_pos+"px"
    // }
    // function mouseUp() {
    //     box.style.cursor="arrow"
    //     document.onmousemove=null
    //     // box.onmousedown=null
    //     document.onmouseup=null
    // }
</script>
<script>
    const box = document.querySelector('.box')
    const container = document.querySelector('.container')
    document.ondragstart=(event)=>{
        var crt = box.cloneNode(true)
        crt.style.background="red"
        event.dataTransfer.setDragImage(crt, 0, 0)
    }
    document.ondrag=(event)=>{
        console.log(event.target)
        event = event || window.event
        var x_pos = event.clientX-event.target.offsetLeft
        var y_pos = event.clientY-event.target.offsetTop
        if(x_pos != 0 && y_pos != 0) {
            event.target.style.transform=`translate(${x_pos}px, ${y_pos}px)`
            // event.target.style.marginLeft=`${x_pos}px`
            // event.target.style.marginTop=`${y_pos}px`
        } 
    }
    document.ondragleave=(event)=>{
        
    }
    document.ondragend=()=>{
        // alert('tes')
    }
    
</script>
<!-- <script>
    const box = document.querySelector('.box')
    const container = document.querySelector('.container')
    let x_pos = 0
    let y_pos = 0
    box.addEventListener('dragstart', (event)=>{
        var crt = box.cloneNode(true)
        crt.style.background="red"
        event.dataTransfer.setDragImage(crt, 0, 0)
        
    })
    box.addEventListener('drag', (event)=>{
        x_pos = event.clientX
        y_pos = event.clientY
        console.log(x_pos)
        box.style.transform=`translate(${x_pos}px, ${y_pos}px) scale(2.0)`
    })
    box.addEventListener('dragover', (event)=>{
        x_pos = document.clientX
        y_pos = document.clientY
        box.style.transform=`translate(${x_pos}px, ${y_pos}px)`
        // event.preventDefault()
    })
    box.addEventListener('dragend', (event)=>{
        x_pos = event.clientX
        y_pos = event.clientY
        box.style.transform=`translate(${x_pos}px, ${y_pos}px)`
    })
    box.addEventListener('dragleave', (event)=>{
        x_pos = event.clientX
        y_pos = event.clientY
        box.style.transform=`translate(${x_pos}px, ${y_pos}px)`
    })
    box.addEventListener('drop', (event)=>{
        x_pos = event.clientX
        y_pos = event.clientY
        box.style.transform=`translate(${x_pos}px, ${y_pos}px)`
    })
</script> -->
</html>